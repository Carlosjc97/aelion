# CONTEXT.txt ‚Äî Edaptia (versi√≥n completa v2)

## Qu√© es

Edaptia convierte una duda espec√≠fica en un **plan corto y √∫til** que cabe en tu agenda. En lugar de cursos eternos, te damos **micro-lecciones de 3‚Äì4 minutos** con peque√±os retos que confirman tu avance. La **calibraci√≥n inicial no es un examen**: solo nos ubica para recomendarte el camino correcto.

## Para qui√©n (ICP)

Profesionales y equipos que necesitan resultados r√°pidos en:

* **Tecnolog√≠a** (p. ej., .NET/SQL).
* **Negocio/Marketing** (p. ej., anal√≠tica, mensajes de ventas).
* **Idiomas profesionales** (p. ej., ingl√©s para trabajo).

Enfoque **ES-first / LATAM**, con ejemplos locales y tono cercano.

## Problemas que resolvemos

* Falta de tiempo y cursos largos que nunca se terminan.
* Contenido gen√©rico que no se adapta al nivel.
* "Par√°lisis por teor√≠a": mucho saber, poco hacer.
* Incertidumbre de si realmente est√°s progresando.

## Propuesta de valor (en cristiano)

* **Avanzas desde el d√≠a 1.** Entras con un objetivo y sales con un plan accionable.
* **Aprendes a tu ritmo.** La calibraci√≥n te ubica y los retos se ajustan a c√≥mo te va.
* **Sin paja.** Cada m√≥dulo tiene objetivo, ejemplo concreto y pr√°ctica guiada.
* **Transparente.** Siempre ves tu progreso y el siguiente paso.
* **En tu idioma, con tu contexto.** Ejemplos LATAM, tono cercano, sin traducciones raras.

## Por qu√© NO usar Coursera/Udemy/ChatGPT

### ‚ùå Alternativas tradicionales:
- Cursos de 40+ horas que nunca terminas
- Contenido gen√©rico para "todos los niveles" (= para nadie)
- No sabes si est√°s progresando de verdad
- Consumo pasivo, sin validaci√≥n

### ‚úÖ Por qu√© S√ç usar Edaptia:
- **2-3 semanas m√°ximo** por skill completo
- **Plan adaptado a TU nivel** desde minuto 1
- **Validaci√≥n constante:** sabes que avanzas
- **Accionable:** m√≥dulos de 3-4 min que caben en tu d√≠a
- **En espa√±ol**, con ejemplos LATAM

## C√≥mo funciona (flujo MVP)

1. **Home** ‚Üí bot√≥n "Generar plan con IA".
2. **Calibraci√≥n corta** (6‚Äì10 preguntas, sin nota visible, < 3 min).
3. **Plan adaptado** a tu nivel: m√≥dulos de 3‚Äì4 min; **primer bloque gratis**.
4. **Gate** (6‚Äì10 √≠tems) que se ajusta a tu desempe√±o despu√©s de cada bloque.
5. **Mock corto** (5 preguntas) si elegiste entrevista/pr√°ctica.
6. **Paywall claro** en 3 momentos: post-calibraci√≥n, al abrir Mock, y al descargar **PDF** de apoyo.
7. **Recordatorios**: D+1 para seguir tu plan y **T‚àí12h** si dijiste que tienes una fecha objetivo.

## Casos de uso espec√≠ficos (ejemplos reales)

### üìä Marketing Analyst que necesita SQL:
**Situaci√≥n:** Puede hacer Excel pero necesita queries para BigQuery/Snowflake
- **D√≠a 1:** Calibraci√≥n ‚Üí detectamos nivel "b√°sico-intermedio"
- **Semana 1:** M√≥dulos de SELECT, WHERE, JOIN (3-4 min c/u)
- **Semana 2:** Agregaciones y subconsultas con ejemplos de marketing
- **Semana 3:** Mock con caso real (an√°lisis de campa√±a)
- **Resultado:** Puede hacer queries reales en su trabajo al d√≠a siguiente

### üíª Dev que cambia a .NET:
**Situaci√≥n:** Conoce Java/Python, necesita aplicar a roles .NET
- **D√≠a 1:** Calibraci√≥n ‚Üí detectamos nivel "intermedio en OOP"
- **Semana 1:** C# syntax y paradigmas .NET espec√≠ficos
- **Semana 2:** Entity Framework y APIs REST
- **Semana 3:** Mock de entrevista t√©cnica con preguntas reales
- **Resultado:** Confianza y conocimiento base para entrevistas .NET

### üåé Profesional que necesita ingl√©s t√©cnico:
**Situaci√≥n:** Lee documentaci√≥n pero no puede participar en calls
- **D√≠a 1:** Calibraci√≥n ‚Üí detectamos nivel "intermedio reading, b√°sico speaking"
- **Semana 1:** Vocabulario t√©cnico y frases comunes en reuniones
- **Semana 2:** Role-plays de situaciones reales (sprint planning, demos)
- **Semana 3:** Mock de presentaci√≥n t√©cnica
- **Resultado:** Participa activamente en calls internacionales

## Qu√© incluye Premium (trial 7 d√≠as ‚Üí $9.99/mes)

### Gratis (siempre):
‚úÖ Calibraci√≥n completa (10 preguntas adaptativas)
‚úÖ M√≥dulo 1 completo + gate quiz
‚úÖ Ver roadmap de aprendizaje
‚ùå M√≥dulos 2-6 bloqueados
‚ùå Mock bloqueado
‚ùå PDF bloqueado

### Premium:
‚úÖ M√≥dulos 2-6 generativos desbloqueados
‚úÖ Gate quizzes adaptativos (‚â•70% para avanzar)
‚úÖ Mock pr√°ctico para validar aprendizaje
‚úÖ **Cheat-sheet PDF** descargable
‚úÖ Guardado de progreso autom√°tico
‚úÖ Contenido generado con IA en tiempo real
‚úÖ Soporte prioritario

**Valor percibido:** "Menos que un caf√© al d√≠a, mejor que 3 cursos de Udemy que no terminas"

## Se√±ales de √©xito que medimos

### Conversi√≥n:
* **Trial start rate ‚â• 6%** (de quienes completan calibraci√≥n)
* **Trial ‚Üí Pago ‚â• 45%** (realista para EdTech de calidad)
* **CAC org√°nico < $5**

### Retention:
* **D7 ‚â• 12%** (usuarios activos despu√©s de 7 d√≠as)
* **D30 ‚â• 25%** (usuarios activos despu√©s de 30 d√≠as)
* **Completion rate ‚â• 40%** (completan el plan completo)

### Performance:
* **p95 plan_rendered < 4 s** (velocidad percibida)
* **Abandono calibration ‚Üí plan < 8%**
* **Crash-free rate ‚â• 99.5%**

## Diferenciales frente a "cursos" tradicionales

* **Micro-aprendizaje con gates adaptativos** (no teor√≠a infinita).
* **Primero utilidad, luego profundidad**: resolvemos la intenci√≥n real del usuario.
* **ES/LATAM nativo e Ingles** (ejemplos y tono locales, no traducciones malas).
* **Tiempo respetado**: todo cabe en bloques de 3‚Äì4 min.
* **Validaci√≥n constante**: sabes exactamente d√≥nde est√°s parado.
* **Accionable desde d√≠a 1**: no "aprender√°s", sino "ya puedes hacer X".

## Principios de producto (no negociables)

1. **No examinamos**, ubicamos. La calibraci√≥n es para nosotros, no para juzgarte.
2. Siempre **muestra progreso** y el **siguiente paso** claro.
3. **Primer bloque gratis** visible antes de pedir pago (demuestra valor primero).
4. **Una sola hip√≥tesis A/B** activa (paywall timing) para aprender r√°pido sin ruido.
5. **Accesible**: foco visible, objetivos t√°ctiles ‚â•44px, contraste suficiente (WCAG AA).
6. **Privado y seguro**: la correcci√≥n vive en servidor; no filtramos respuestas correctas al cliente.
7. **R√°pido por dise√±o**: 500 ms de *skeleton*, p95 < 4 s para plan completo.

## Qu√© ya decidimos para el MVP

### Contenido:
* **Track inicial**: .NET/SQL con banco de √≠tems (‚â•60‚Äì100 preguntas calibradas) esto solo es el fallback no tiene que usarse para nada mas que cuando la apy key realmente no funcione.
* **Estructura**: Calibraci√≥n ‚Üí bloques tem√°ticos adaptativos segun convenga debido a lo que se esta estudiando ‚Üí Mock ‚Üí PDF
* **Extensi√≥n**: 12-15 m√≥dulos que contengan lecciones de 3-4 min c/u

### Adaptativo:
* **Motor simple en servidor**: ability en ‚àí3..+3, +0.6 acierto / ‚àí0.5 error
* **Sin repetir subtema** consecutivo (variedad percibida)
* **Sin LLM durante test** (costo cero, velocidad m√°xima)

### LLM:
* **1 sola llamada** post-calibraci√≥n para `recommendedOutline`
* **Cach√© agresivo** por `{courseId, level}`
* **Diffs por skillProfile** (no regenerar todo)

### Analytics:
* **GA4**: eventos FTUE, monetizaci√≥n, latencias
* **Remote Config**: feature flags (panic_mode, paywall_variant)
* **Crashlytics + Performance**: monitoreo b√°sico
* **PostHog**: solo replay opcional (apagado por default)

### Notificaciones:
* **D+1**: recordatorio suave para continuar plan
* **T‚àí12h**: si usuario dijo que tiene fecha objetivo
* **Sin T‚àí90**: no agregamos presi√≥n innecesaria en MVP

### Monetizaci√≥n:
* **A/B √∫nico**: ubicaci√≥n de paywall (post-calibraci√≥n vs. abrir bloque/modulo 2)
* **3 CTAs claros**: post-calibraci√≥n, Mock, PDF
* **Trial 7 d√≠as** sin pedir tarjeta upfront
* **Cobro**: solo en playstore por el momento.; pol√≠ticas de tienda en apps

### QA/SLOs:
* Reanudar sesi√≥n donde quedaste
* Bloquear "back" en test (no hacer trampa)
* Idempotencia en correcci√≥n
* Crash-free ‚â• 99.5% en staging 24h antes de prod

## Modelo de negocio (freemium con trial)

* **Gratis**: calibraci√≥n + 1er bloque (demostraci√≥n de valor).
* **Trial 7 d√≠as**: acceso completo + Mock + PDF (sin tarjeta).
* **Premium**: $4.99/mes (early bird) ‚Üí $9.99/mes (despu√©s de 500 usuarios).
* **Paywall en 3 momentos** (ver flujo arriba).

## Stack (explicado sin jerga)

* **App**: Flutter (r√°pida y multiplataforma, iOS + Android).
* **Backend**: Firebase (login, Firestore, Functions, Storage).
* **Mensajes**: FCM push + emails transaccionales (SendGrid/Postmark).
* **Sitio**: Landing y legal en p√°ginas est√°ticas r√°pidas (Astro/Next).
* **Pago**: Stripe + RevenueCat para subscripciones.

Todo pensado para **salir ya**, medir y mejorar con ingresos reales.

## Privacidad y confianza

* La calibraci√≥n es solo para ajustar el nivel, no para juzgar.
* Guardamos el progreso para que retomes donde ibas.
* No compartimos respuestas correctas del banco de √≠tems en el dispositivo.
* Cumplimos GDPR/CCPA b√°sico (borrado de datos, exportaci√≥n).

## Riesgos identificados y c√≥mo los mitigamos

### üö® Riesgo: Usuario no completa calibraci√≥n
**Mitigaci√≥n:**
- Calibraci√≥n < 3 min (6-10 preguntas max)
- Progress bar visible en todo momento
- Sin nota visible (reduce ansiedad)
- Copy claro: "Esto NO es un examen"

### üö® Riesgo: Contenido percibido como "muy f√°cil/dif√≠cil"
**Mitigaci√≥n:**
- Adaptativo ajusta en tiempo real (gates cada bloque)
- Feedback constante del nivel actual
- Opci√≥n de "saltar bloque" si muy f√°cil
- Opci√≥n de "repasar" si muy dif√≠cil

### üö® Riesgo: Trial‚ÜíPago bajo (<30%)
**Mitigaci√≥n:**
- Primer bloque gratis demuestra valor ANTES de paywall
- 3 CTAs estrat√©gicos (no spam)
- Copy optimizado en paywall (beneficios > features)
- A/B test de timing basado en engagement
- Grandfathering para early adopters ($4.99 forever)

### üö® Riesgo: Churn D7 alto (>35%)
**Mitigaci√≥n:**
- Notificaciones contextuales (no gen√©ricas)
- Progress visible (motivaci√≥n intr√≠nseca)
- Modules cortos (3-4 min, momentum constante)
- Siguiente paso siempre claro

### üö® Riesgo: Performance lenta (>4s)
**Mitigaci√≥n:**
- Skeleton loading (feedback inmediato)
- Cach√© agresivo de LLM
- Plan rendering en background
- Monitoreo con Firebase Performance

## Hoja de ruta inmediata (7‚Äì14 d√≠as)

1. **Semana 1-2**: Entregar FTUE completo con track .NET/SQL
2. **D√≠a 3**: M√©tricas y dashboards b√°sicos funcionando
3. **D√≠a 7**: Internal testing con 20-50 usuarios
4. **D√≠a 14**: Lanzamiento p√∫blico con **primer bloque gratis** + **trial 7d**
5. **D√≠a 15+**: Medir se√±al y decidir iteraciones semanales

## Lo que NO somos (para evitar desv√≠os)

‚ùå **NO somos** Netflix de cursos (no acumules, avanza)
‚ùå **NO somos** un examen o test de conocimiento (no te juzgamos)
‚ùå **NO prometemos** "experto en 7 d√≠as" (realismo > hype)
‚ùå **NO hacemos** gamificaci√≥n forzada (progreso real > badges vac√≠os)
‚ùå **NO vendemos** certificados oficiales (vendemos skills aplicables)
‚ùå **NO reemplazamos** pr√°ctica real (te preparamos para ella)
‚ùå **NO somos** para curiosos casuales (para profesionales con objetivo claro)

## Tono y valores (c√≥mo hablamos)

### Principios de comunicaci√≥n:
1. **Claro > Clever**
   ‚úÖ "Aprende SQL en 3 semanas"
   ‚ùå "Desbloquea tu potencial data-driven"

2. **√ötil > Inspiracional**
   ‚úÖ "Siguiente m√≥dulo: JOIN queries (3 min)"
   ‚ùå "¬°Sigue tu viaje de aprendizaje! üöÄ"

3. **Progreso visible > Gamificaci√≥n**
   ‚úÖ "4/12 m√≥dulos completados"
   ‚ùå "¬°Ganaste 500 puntos y subiste de nivel!"

4. **Realista > Promesas exageradas**
   ‚úÖ "En 2-3 semanas tendr√°s las bases s√≥lidas"
   ‚ùå "Convi√©rtete en experto en 7 d√≠as"

### Copy guidelines:
- Sin jerga innecesaria (habla como humano)
- Verbos de acci√≥n en CTAs ("Empezar plan" no "Continuar")
- Beneficios antes que features ("Aprende SQL" no "Accede a 100 preguntas")
- Siempre mostrar progreso + siguiente paso
- Usar "t√∫" no "usted" (cercano pero profesional)

## C√≥mo usar este documento

### Para devs/dise√±ers:
Lee esto primero ‚Üí entiendes el contexto completo ‚Üí contribuyes alineado

### Para IAs (Codex/ChatGPT/Claude):
"Lee /context/CONTEXT.txt y dame X seg√∫n estos principios"

### Para decisiones:
¬øAgregar feature X? ‚Üí Consulta "Principios no-negociables" + "Lo que NO somos"

### Para pitch:
Secci√≥n "Qu√© es" + "Propuesta de valor" = elevator pitch de 2 min

---

**√öltima actualizaci√≥n:** 9 Noviembre 2025  
**Versi√≥n:** 2.0 (versi√≥n completa post-decisiones MVP)  
**Pr√≥xima revisi√≥n:** Despu√©s de primeros 100 trials (ajustar seg√∫n data real)

## Ahora: contexto actual
Describe que ...

## Ahora: contexto actual de Edaptia
- La aplicaciÔøΩn corre sobre Flutter + Firebase + funciones generativas en Node.js, el flujo adaptativo usa LearnerState y genera mÔøΩdulos/checkpoints con GPT-4o.
- El backend registra cada respuesta en Firestore y usa el cache en i_cache para los quizzes, mientras el frontend enfoca la UI, el streak y el paso hacia AdaptiveJourneyScreen.
- Actualmente placementQuizStart detecta fallos porque logOpenAiUsage escribe moduleNumber: undefined y Firestore rechaza el doc, lo que activa el fallback SQL aunque OpenAI devuelva preguntas temÔøΩticas.

## Contexto operativo de la app
- Home dispara el quiz de calibraciÔøΩn y luego abre AdaptiveJourneyScreen que escucha users/{uid}/adaptiveState/summary para reflejar progreso y generar contenido on-demand.
- Las funciones adaptativas (adaptivePlanDraft, adaptiveModuleGenerate, adaptiveCheckpointQuiz, adaptiveBooster) viven en functions/src/generative-endpoints.ts y usan schemas AJV para validar cada respuesta antes de guardarla.
- El flujo depende del estado de entitlements/premium, del streak diario y de una racha de m√≥dulos: un fallback repetido duplica tokens y degrada la experiencia.

## Problemas actuales a resolver (2e2 forense)
1. placementQuizStart sigue cayendo en curated-fallback porque logOpenAiUsage escribÔøΩa moduleNumber undefined y Firestore rechazaba el documento.
2. El cache ai_cache puede devolver preguntas repetidas, por lo que es difÔøΩcil confirmar que cada tema se genera con la IA.
3. Necesitamos reforzar los logs en placementQuizStartLive para distinguir entre errores de validacion y fallos reales de OpenAI y asÔøΩ no disparar un fallback falso.
4. La UI Flutter aborta despuÔøΩs de 25 s si OpenAI responde lento; aunque aumentamos el timeout a 45 s, hay que asegurar que las respuestas lleguen antes del fallback.

## Proximos pasos urgentes
- Asegurar que logOpenAiUsage sanea todos los campos undefined y revisar cada metadato insertado para evitar nuevos rechazos de Firestore.
- Invalidar ai_cache cuando placementQuizStart detecta fallback para que la prÔøΩxima invocaciÔøΩn genere contenido nuevo.
- Reforzar los logs de placementQuizStartLive (Cloud Run) y documentar el error en los audit docs para mantener el seguimiento forense (2e2).
