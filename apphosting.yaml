runtime: nodejs20

# Specify the server directory as the root
rootDirectory: server

runConfig:
  entrypoint: node server.js
  cpu: 1
  memoryMiB: 512
  minInstances: 0
  maxInstances: 10
  concurrency: 80

env:
  # Usa 'variable' en lugar de 'name'
  # Limita ambas a RUNTIME para que NO se escriban durante BUILD
  - variable: PORT
    value: "8080"
    availability:
      - RUNTIME

  - variable: OPENAI_API_KEY
    secret: OPENAI_API_KEY
    availability:
      - RUNTIME

  - variable: NODE_ENV
    value: production
    availability:
      - RUNTIME
